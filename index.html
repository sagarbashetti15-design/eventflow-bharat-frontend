
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EventFlow Bharat</title>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(120deg,#eef2f3,#d9e4f5);
  padding: 30px;
}
.container { max-width: 1100px; margin: auto; }
.card {
  background: white;
  padding: 25px;
  border-radius: 14px;
  margin-bottom: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,.08);
}
.packages {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
  gap: 20px;
}
.package {
  border: 2px solid #eee;
  padding: 20px;
  border-radius: 12px;
  transition: .3s;
}
.package:hover {
  border-color:#2c7be5;
  transform: translateY(-4px);
}
button {
  background:#2c7be5;
  color:white;
  border:none;
  padding:14px;
  border-radius:8px;
  width:100%;
  cursor:pointer;
}
input {
  width:100%;
  padding:12px;
  margin:10px 0;
  border-radius:8px;
  border:1px solid #ccc;
}
#booking,#success,#admin { display:none; }
.ai { background:#f0f6ff; border-left:5px solid #2c7be5; }
</style>
</head>

<body>
<div class="container">

<div class="card">
  <h1>EventFlow Bharat</h1>
  <p>Book â†’ Pay â†’ Relax. AI-powered event booking.</p>
</div>

<div class="card ai">
  <h3>ðŸ¤– AI Event Assistant</h3>
  <p id="aiText">What event are you planning?</p>
  <button onclick="askAI('wedding')">Wedding</button>
  <button onclick="askAI('birthday')">Birthday</button>
  <button onclick="askAI('corporate')">Corporate</button>
</div>

<div class="card">
  <h2>Select Package</h2>
  <div class="packages">
    <div class="package">
      <h3>Basic â€“ â‚¹9,999</h3>
      <p>Photography + Decoration</p>
      <button onclick="selectPackage('Basic',9999)">Choose</button>
    </div>
    <div class="package">
      <h3>Premium â€“ â‚¹24,999</h3>
      <p>Photography + DJ + Decor</p>
      <button onclick="selectPackage('Premium',24999)">Choose</button>
    </div>
    <div class="package">
      <h3>Luxury â€“ â‚¹49,999</h3>
      <p>Complete Event Management</p>
      <button onclick="selectPackage('Luxury',49999)">Choose</button>
    </div>
  </div>
</div>

<div class="card" id="booking">
  <h2>Book Event</h2>
  <p>Package: <b id="pkg"></b></p>
  <input id="name" placeholder="Event Name">
  <input id="date" type="date">
  <input id="venue" placeholder="Venue">
  <input id="email" placeholder="Email">
  <button onclick="pay()">Pay & Book</button>
</div>

<div class="card" id="success">
  <h2>ðŸŽ‰ Booking Confirmed</h2>
  <p>Our team will contact you soon.</p>
</div>

<div class="card">
  <button onclick="loadAdmin()">Admin Dashboard</button>
</div>

<div class="card" id="admin"></div>

</div>

<script>
const API = "https://eventflow-bharat-backend.onrender.com";
let selectedPackage = "";
let amount = 0;

function selectPackage(p,a){
  selectedPackage=p;
  amount=a;
  document.getElementById("pkg").innerText=p;
  document.getElementById("booking").style.display="block";
}

async function pay(){
  if(!selectedPackage){
    alert("Select a package first");
    return;
  }

  const keyRes = await fetch(API+"/payment/key");
  const { key } = await keyRes.json();

  const order = await fetch(API+"/payment/order",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ amount })
  }).then(r=>r.json());

  const options = {
    key,
    amount: order.amount,
    currency: "INR",
    name: "EventFlow Bharat",
    order_id: order.id,
    handler: async function (response) {

      await fetch(API+"/payment/verify",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify(response)
      });

      await fetch(API+"/events",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({
          name: name.value,
          date: date.value,
          venue: venue.value,
          email: email.value,
          package: selectedPackage
        })
      });

      booking.style.display="none";
      success.style.display="block";
    }
  };

  new Razorpay(options).open();
}

async function loadAdmin(){
  const stats = await fetch(API+"/admin/stats").then(r=>r.json());
  const list = await fetch(API+"/admin/events").then(r=>r.json());
  admin.style.display="block";
  admin.innerHTML = `
    <h3>Admin Dashboard</h3>
    <p>Total Events: ${stats.totalEvents}</p>
    <p>Total Revenue: â‚¹${stats.revenue}</p>
    <pre>${JSON.stringify(list,null,2)}</pre>
  `;
}

async function askAI(q){
  const res = await fetch(API+"/ai/assist",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ question:q })
  });
  const data = await res.json();
  aiText.innerText = data.reply;
}
</script>

</body>
</html>
